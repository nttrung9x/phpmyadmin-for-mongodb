#######
# PhpMongoAdmin - Web based MongoDB management written in php using Vue & Laravel
#
# WARNING !! PUBLIC ACCESS ENABLED !!
#
# Allowing PhpMongoAdmin to anyone other than localhost should be considered
# dangerous unless properly secured by SSL

#######
# This configuration is meant for creating a Virtual Host implementation
# It is NOT meant to be used for creating a Global install: http://my.ebdomain.com/phpmongoadmin
# For a Global setup use the: setup/apache/global/phpMongoAdmin.conf sample configutation
#
#   Setting up a VirtualHost is not yet supported via a shell script
#
#######

#######
# Creating a Virtual Host installtion requires some planning, due to the many possible location for the application code
# This virtualhost configuration makes the assumption that the default apache web root will be used
# Using this configuration requires the application base to be installed at: /var/www
# Here are some viable alternative web root locations:
# - /var/hosting/sites/phpMongoAdmin
# - /home/< user >/phpMongoAdmin
#######
<VirtualHost *:80>
    ServerAdmin     email@yourdomain.com
    ServerName      host.yourdomain.com

    DocumentRoot    /var/hosting/sites/phpmongoadmin/public
    DirectoryIndex  index.php

    <Directory /var/hosting/sites/phpmongoadmin/public>
        AddDefaultCharset UTF-8
        AllowOverride All
        Options -Indexes +FollowSymLinks +Includes

        #######
        # In order to expose your install to the wild: add a public IP address
        #######
        <IfModule mod_authz_core.c>
            # Apache 2.4
            <RequireAny>
                # allows public access
                Require all granted
            </RequireAny>
        </IfModule>
        <IfModule !mod_authz_core.c>
            # Apache 2.2
            Order Deny,Allow
            Deny from All
            # allows public access
            Allow from All
        </IfModule>
    </Directory>

    ErrorLog /var/hosting/sites/phpmongoadmin/storage/logs/phpmongoadmin_error.log
    CustomLog /var/hosting/sites/phpmongoadmin/storage/logs/phpmongoadmin_access.log common

    <IfModule mod_rewrite.c>
    #   RewriteEngine on
    #   RewriteRule ^/(.*)$ https://host.yourdomain.com/$1 [L,R=301]
    </IfModule>

    # All these directories do not require access over HTTP - best to lock them down to be safe
    <Directory /var/hosting/sites/phpmongoadmin/app>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/bootstrap>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/config>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/database>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/resources>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/routes>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/setup>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/storage>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/tests>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

    <Directory /var/hosting/sites/phpmongoadmin/vendor>
        Order Deny,Allow
        Deny from All
        Allow from None
    </Directory>

</VirtualHost